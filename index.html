<!DOCTYPE html>
<html class="wf-permanentmarker-n4-active wf-gloriahallelujah-n4-active wf-mysteryquest-n4-active wf-donegalone-n4-active wf-active"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>phosphorus 3 BETA</title>
<link rel="stylesheet" href="player.css">
<link rel="stylesheet" href="index.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Donegal+One%7CGloria+Hallelujah%7CPermanent+Marker%7CMystery+Quest&amp;subset=latin,latin,latin,latin" media="all">

</head><body><div class="area" id="title-area" style="height: 172px; transition: height 0.2s;">
<h1 class="title">phosphorus 3 BETA</h1>
<p>phosphorus 3 is useful for playing slow Scratch 3.0 projects much faster. Try it out by pasting a URL or project ID into the field below or <a class="dropdown">choosing an example<select id="examples">
  <option value="">
  </option><option value="11397100">3D Remix by DadOfMrLog
  </option><option value="15945630">O by DCPU-16
  </option><option value="10128407">Paper Minecraft by griffpatch
  </option><option value="16207935">Alone in the depths by sticku
  </option><option value="16205373">3D Framework by DadOfMrLog
  </option><option value="31903442">gb.sb2 [Dr. Mario] by DCPU-16
  </option><option value="34791164">gb.sb2 [Mario Land 2] by DCPU-16
  </option><option value="21554369">Epic Ninja by griffpatch
  </option><option value="15832807">Pretty by blob8108
</option></select></a>.</p>
</div>

<div class="area" id="player-area" style="height: 0px; transition: height 0.2s;">
<div class="controls">
  <span class="stop"></span>
  <span class="pause"></span>
  <span class="flag" title="Press Shift + Click to enable Turbo Mode, which eliminates certain block delays and can make the project faster."></span>
  <div class="turbo" style="display: none;">Turbo Mode</div>
  <span class="full-screen"></span>
</div>
<div class="player"></div>
<div class="internal-error" style="display: none;">
  Uh-oh! An internal error occurred. <a id="error-bug-link" target="_blank" href="https://github.com/lisa-wolfgang/phosphorus-3/issues/new">Click here</a> to file a bug report.
</div>
</div>

<div class="title">
  <div class="progress-bar" style="display: none;"></div>
  <input class="url" value="Paste the project link here...">
  <a target="_blank" class="project-link" title="View project on Scratch" href=""></a>
</div>

<div class="area" id="project-area" style="height: 0px; transition: height 0.2s;">
<section class="package">
  <h1>Package this project</h1>
  <p>Get a link to a web page that automatically runs your project in phosphorus 3.</p>
  <p>
    <a href="about:blank" target="_blank" id="package-link">Package</a>
    <input type="checkbox" id="package-turbo">
    <label for="package-turbo">Turbo mode</label>
    <input type="checkbox" id="package-full-screen" checked="">
    <label for="package-full-screen">Full screen</label>
  </p>
</section>
<section class="package">
  <h1>Embed this project</h1>
  <p>Include the phosphorus 3 player in your web site.</p>
  <p>
    <input readonly="" id="embed-code">
    <input type="checkbox" id="embed-auto-start" checked="">
    <label for="embed-auto-start">Start automatically</label>
    <input type="checkbox" id="embed-light-content">
    <label for="embed-light-content">Light controls</label>
    <input type="checkbox" id="embed-hide-controls">
    <label for="embed-hide-controls">Hide UI</label>
  </p>
</section>
<section>
  <h1>Report a problem</h1>
  <p>phosphorus 3 is still in beta. New Scratch 3.0 features may not work correctly. <a id="bug-link" target="_blank" href="https://github.com/lisa-wolfgang/phosphorus-3/issues/new?body=%0A%0A%0AMozilla%2F5.0%20(iPhone%3B%20CPU%20iPhone%20OS%2012_1_4%20like%20Mac%20OS%20X)%20AppleWebKit%2F605.1.15%20(KHTML%2C%20like%20Gecko)%20Version%2F12.0%20Mobile%2F15E148%20Safari%2F604.1">Click here</a> to report a problem with this project.</p>
</section>
</div>
<section>
  <h1>Credits</h1>
  <p>The changes in phosphorus 3 was made by <a href="https://github.com/lisa-wolfgang">lisa_wolfgang</a>.<br><br>phosphorus was created by <a href="https://github.com/nathan">Nathan</a>. Its CPS-style compilation and overall design was inspired by <a href="https://github.com/RHY3756547">Rhys</a>'s <a href="https://code.google.com/p/sb2-js/">sb2.js</a>. It would have more bugs if not for <a href="https://github.com/trumank">Truman</a> and <a href="https://github.com/tjvr">Tim</a>. It uses the <a href="https://stuk.github.io/jszip/">JSZip</a> library, created by <a href="https://github.com/stuk">Stuart Knightley</a>, <a href="https://github.com/dduponchel">David Duponchel</a>, Franz Buchinger, and <a href="https://github.com/aadsm">António Afonso</a>, to read <code>.sb2</code> files and compressed projects, and the <a href="https://code.google.com/p/canvg/">canvg</a> library, created by <a href="https://code.google.com/u/gabelerner@gmail.com/">Gabe Lerner</a>, to render SVGs in <code>&lt;canvas&gt;</code> elements.
  </p><h1>Code</h1>
  <p>The source code for phosphorus 3 is available <a href="https://github.com/lisa-wolfgang/phosphorus-3">on GitHub</a>.</p>
  <h1>Original Version</h1>
  <p>The original version of Phosphorus can be found <a href=“https://phosphorus.github.io”>here</a>.</p>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js" type="text/javascript" async=""></script><script src="fonts.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jszip/2.4.0/jszip.js"></script>
<script src="lib/rgbcolor.js"></script>
<script src="lib/StackBlur.js"></script>
<script src="lib/canvg.js"></script>
<script src="phosphorus.js"></script>
<script src="player.js"></script>
<script>

(function() {
  'use strict';

  var prefix = 'Paste the project link here...';

  var initialId = location.hash.substr(1);
  if (initialId === 'zip') initialId = '';

  var titleArea = document.querySelector('#title-area');
  var playerArea = document.querySelector('#player-area');
  var projectArea = document.querySelector('#project-area');

  playerArea.style.height = projectArea.style.height = 'auto';
  var titleAreaHeight = titleArea.offsetHeight;
  var playerAreaHeight = playerArea.offsetHeight;
  var projectAreaHeight = projectArea.offsetHeight;
  playerArea.style.height = projectArea.style.height = 0;

  var examples = document.querySelector('#examples');
  var urlInput = document.querySelector('.url');
  urlInput.value = prefix + initialId;

  var progressBar = document.querySelector('.progress-bar');
  var player = document.querySelector('.player');
  var projectLink = document.querySelector('.project-link');
  var bugLink = document.querySelector('#bug-link');

  var packageLink = document.querySelector('#package-link');
  var packageTurbo = document.querySelector('#package-turbo');
  var packageFullScreen = document.querySelector('#package-full-screen');

  var embedCode = document.querySelector('#embed-code');
  var embedAutoStart = document.querySelector('#embed-auto-start');
  var embedLightContent = document.querySelector('#embed-light-content');
  var embedHideControls = document.querySelector('#embed-hide-controls');

  var timeout;
  urlInput.addEventListener('input', function() {
    var ss = urlInput.selectionStart;
    var se = urlInput.selectionEnd;
    var url = urlInput.value;
    var id = url.match(/\d+/g) || [''];
    while (id.length > 1 && id.indexOf(P.player.projectId) > -1) {
      id.splice(id.indexOf(P.player.projectId), 1);
    }
    id = id[0];
    urlInput.value = url = prefix + id;
    urlInput.selectionStart = urlInput.selectionEnd = Math.max(prefix.length, ss);
    clearTimeout(timeout);
    if (P.player.projectId !== id) {
      timeout = setTimeout(function() {
        location.hash = '#' + id;
      }, 300);
    }
  });
  urlInput.addEventListener('focus', function() {
    setTimeout(function() {
      if (/\d/.test(urlInput.value)) {
        urlInput.select();
      }
    });
  });

  examples.addEventListener('change', function() {
    if (examples.value) {
      location.hash = '#' + examples.value;
      examples.selectedIndex = 0;
    }
  });

  window.addEventListener('hashchange', function() {
    var id = location.hash.substr(1);
    if (id !== 'zip') {
      if (+id !== +id) id = '';
      urlInput.value = prefix + id;
    }
    load(id);
  });

  function show(id) {
    titleArea.style.height = id ? 0 : titleAreaHeight + 'px';
    playerArea.style.height = id ? playerAreaHeight + 'px' : 0
    projectArea.style.height = id ? projectAreaHeight + 'px' : 0;
    if (!id) urlInput.focus();
  }

  function load(id) {
    if (id !== 'zip') {
      show(id);
    } else {
      id = '';
    }

    document.title = 'phosphorus 3 BETA';
    P.player.load(id, function(stage) {
      stage.triggerGreenFlag();
    }, function(title) {
      document.title = title ? title + ' \xb7 phosphorus' : 'phosphorus';
      updateBugLink();
    });

    projectLink.href = P.player.projectURL;
    updateBugLink();
    updatePackageLink();
    updateEmbedCode();
  }

  function updateBugLink() {
    bugLink.href = P.player.projectId ? 'https://github.com/lisa-wolfgang/phosphorus-3/issues/new?title=' + encodeURIComponent(P.player.projectTitle || P.player.projectURL) + '&body=' + encodeURIComponent('\n\n\n' + P.player.projectURL + '\nhttps://lisa-wolfgang.github.io/phosphorus-3/#' + P.player.projectId + '\n' + navigator.userAgent) : 'https://github.com/lisa-wolfgang/phosphorus-3/issues/new?body=' + encodeURIComponent('\n\n\n' + navigator.userAgent);
  }

  function updatePackageLink() {
    packageLink.href = P.player.projectId ? '/app.html?id=' + P.player.projectId + '&turbo=' + packageTurbo.checked + '&full-screen=' + packageFullScreen.checked : 'about:blank';
  }

  packageTurbo.addEventListener('change', updatePackageLink);
  packageFullScreen.addEventListener('change', updatePackageLink);

  function updateEmbedCode(e) {
    embedCode.value = P.player.projectId ? '<script src=https://' + location.host + '/embed.js?id=' + P.player.projectId + (embedHideControls.checked ? '&ui=false' : '&auto-start=' + embedAutoStart.checked + '&light-content=' + embedLightContent.checked) + '></' + 'script>' : '';
    embedAutoStart.disabled =
    embedLightContent.disabled = embedHideControls.checked;
    if (embedHideControls.checked) embedAutoStart.checked = true;
    if (e) embedCode.focus();
  }

  function selectEmbedCode() {
    setTimeout(function() {
      embedCode.select();
    });
  }

  embedCode.addEventListener('focus', selectEmbedCode);
  embedCode.addEventListener('click', selectEmbedCode);
  embedHideControls.addEventListener('change', updateEmbedCode);
  embedAutoStart.addEventListener('change', updateEmbedCode);
  embedLightContent.addEventListener('change', updateEmbedCode);

  load(initialId);

  setTimeout(function() {
    function setTransition(el) {
      el.style.WebkitTransition =
      el.style.MozTransition =
      el.style.OTransition =
      el.style.transition = 'height 0.2s';
    }
    setTransition(titleArea);
    setTransition(playerArea);
    setTransition(projectArea);
  });

  function cancel(e) {
    e.preventDefault();
    e.dataTransfer.dropEffect = 'copy';
  }
  document.body.addEventListener('dragover', cancel);
  document.body.addEventListener('dragenter', cancel);

  document.body.addEventListener('drop', function(e) {
    e.preventDefault();

    var f = e.dataTransfer.files[0];

    if (f) {
      location.hash = '#zip';
      show('zip');
      var ext = f.name.split('.').pop();
      if (ext === 'sb2' || ext === 'zip') {
        var request = P.IO.loadSB2File(f);
      } else if (ext === 'json') {
        request = P.IO.loadJSONFile(f);
      }
      if (request) {
        P.player.showProgress(request, function(stage) {
          stage.triggerGreenFlag();
        });
      }
    }
  });

}());

</script>
</body></html>
